# Execute command on remote server to get users and group memberships
$userGroupsInfo = Invoke-Command -ComputerName ServerName -ScriptBlock {
    Get-WmiObject -Class Win32_GroupUser |
    ForEach-Object {
        $user = ([WMI]$_.PartComponent).Caption
        $group = ([WMI]$_.GroupComponent).Caption
        [PSCustomObject]@{
            UserName = $user
            GroupName = $group
        }
    }
} -Authentication Negotiate -ErrorAction SilentlyContinue

$userGroupsInfo
