# Read server names from a file or array
$servers = @("Server1", "Server2")  # Replace or load from file

foreach ($server in $servers) {
    Write-Host "Processing server: $server"
    try {
        $ramInfo = Invoke-Command -ComputerName $server -ScriptBlock {
            $totalMemory = (Get-CimInstance -ClassName Win32_ComputerSystem).TotalPhysicalMemory
            [PSCustomObject]@{
                ComputerName = $env:COMPUTERNAME
                TotalRAM_GB  = [math]::Round($totalMemory / 1GB, 2)
            }
        } -Authentication Negotiate -ErrorAction SilentlyContinue

        foreach ($ram in $ramInfo) {
            Write-Host "$($ram.ComputerName): $($ram.TotalRAM_GB) GB RAM"
        }
    }
    catch {
        Write-Host "Failed to connect to $server: $_" -ForegroundColor Red
    }
}
