# Define the path to the server list file
$file = "C:\Path\To\Your\servers.txt"

# Check if the file exists
if (Test-Path $file) {
    # Read server names
    $servers = Get-Content $file

    foreach ($server in $servers) {
        Write-Host "`nProcessing server: $server" -ForegroundColor Cyan
        try {
            Invoke-Command -ComputerName $server -Authentication Negotiate -ScriptBlock {
                # RAM
                $ram = (Get-CimInstance Win32_ComputerSystem).TotalPhysicalMemory
                $ramGB = [math]::Round($ram / 1GB, 2)

                # CPU
                $cpuCores = (Get-CimInstance Win32_Processor | Measure-Object -Property NumberOfLogicalProcessors -Sum).Sum

                # Disks
                $disks = Get-CimInstance Win32_LogicalDisk | Where-Object { $_.DriveType -eq 3 } | Select-Object `
                    DeviceID, VolumeName,
                    @{Name="Size(GB)"; Expression = {[math]::Round($_.Size / 1GB, 2)}},
                    @{Name="Free(GB)"; Expression = {[math]::Round($_.FreeSpace / 1GB, 2)}},
                    @{Name="Free(%)"; Expression = {[math]::Round(($_.FreeSpace / $_.Size) * 100, 2)}}

                # Output
                Write-Output "Total RAM (GB): $ramGB"
                Write-Output "CPU Cores: $cpuCores"
                Write-Output "Disk Info:"
                $disks | Format-Table -AutoSize
            } -ErrorAction Stop
        } catch {
            Write-Host "Failed to connect to $server: $_" -ForegroundColor Red
        }
    }
} else {
    Write-Host "Server list file not found: $file" -ForegroundColor Yellow
}
